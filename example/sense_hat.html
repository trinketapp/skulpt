<html>
  <head>
    <title>Sense Hat Example</title>
    <script src="../dist/skulpt.min.js" type="text/javascript"></script>
    <script src="../dist/skulpt-stdlib.js" type="text/javascript"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"> </script>
  </head>

  <body>
    <div id="mycanvas"  height="500" width="800"
	style="border-style: solid;"></div>

<textarea id="code" rows="24" cols="80">
import sys
print property
import sense_hat
#print "test" 

</textarea>
<button id="runbtn">Run</button>
<textarea id="output" rows="24" cols="80"></textarea>
    <script>
        window.sense_hat = { }; // create sense_hat value placeholder
        function emit(event, data) {
            console.info(event, data);
        }
        
        var btn = document.getElementById('runbtn');
        var prog = document.getElementById('code');
        var output = document.getElementById('output');
        btn.addEventListener('click', function (e) {
            function builtinRead(x) {
                if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined)
                    throw "File not found: '" + x + "'";
                return Sk.builtinFiles["files"][x];
            }
            (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = 'mycanvas';

            Sk.configure({ 
                read: builtinRead,
                sense_hat: window.sense_hat,
                sense_hat_emit: emit,
                output: function (val) {
                    var newText = output.value + val + '\n';
                    output.value = newText;
                } 
            });

            Sk.misceval.asyncToPromise(function() {
            return Sk.importMainWithBody("<stdin>", false, prog.value, true);
            });
        });
    </script>
  </body>
</html>
